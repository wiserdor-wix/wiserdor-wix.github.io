function getViewportSize(){var a=document.documentElement;return{width:a.clientWidth,height:a.clientHeight}}!function(a){var b=getViewportSize().width,c=getViewportSize().height;$.fn.pageFlipper=function(a){function d(){M={top:E.pageHeight,left:2*E.pageWidth},N={top:E.pageHeight,left:2*E.pageWidth},F=!1}function e(a){J=$("<div id='canvasHolder'></div>"),J.insertAfter(a).addClass(E.className).attr("width",2*E.pageWidth).attr("height",E.pageHeight+2*E.pageHeightOffset),H=$("<canvas id='mainCanvas'></canvas>"),J.append(H),H.attr("width",2*E.pageWidth).attr("height",E.pageHeight+2*E.pageHeightOffset),I=$("<canvas id='tempCanvas'></canvas>"),I.css({position:"absolute",top:H.position().top,left:H.position().left}).attr("width",H.width()).attr("height",H.height()).appendTo(J),K=H.get(0).getContext("2d"),L=I.get(0).getContext("2d"),K.strokeStyle="#aaaaaa",K.beginPath(),K.moveTo(E.pageWidth,E.pageHeightOffset),K.lineTo(E.pageWidth,E.pageHeight+E.pageHeightOffset),K.stroke()}function f(){$(I).bind("mousemove",m).bind("mouseout",l).bind("mousedown",k).bind("touchstart",k),$(document).bind("mousemove",function(a){W=!1,U||T&&(M={left:a.pageX-$(J).position().left,top:a.pageY-E.pageHeightOffset+70})}).bind("touchmove",function(a){if(W=!1,!U&&T&&null!=a.originalEvent&&1==a.originalEvent.touches.length){a.preventDefault();var b=a.originalEvent.touches[0];M={left:b.screenX-$(J).position().left,top:b.screenY-E.pageHeightOffset+70}}}).bind("mousedown",function(a){(a.pageX<J.position().left||a.pageX>J.position().left+J.width()||a.pageY<J.position().top+E.pageHeightOffset||a.pageY>J.position().top+J.height()-E.pageHeightOffset)&&(V=!0)}).bind("mouseup",j).bind("touchend",j)}function g(){L.clearRect(0,0,I.width(),I.height())}function h(){U&&(n(),g(),r());var a=F?0==_:_==Y-2;if(!a){var b=F?_>0:Y-2>_;b&&(M={top:E.pageHeight,left:F?2*E.pageWidth:0},N={left:F?1:2*E.pageWidth-1,top:E.pageHeight-1},U=!0,G=i(F))}}function i(a){return function(){_+=a?-2:2,M={left:a?0:2*E.pageWidth,top:E.pageHeight},N=M,t(),g(),T=!1,E.pageFlipCallback&&E.pageFlipCallback(_)}}function j(a){if(!V){if(W)return void h();if(!U){if(T=!1,F?0==_:_==Y-2)return;var b=a.pageX-$(J).position().left,c=F?b>E.pageWidth:b<E.pageWidth;c?(M={left:F?E.spreadWidth:0,top:E.pageHeight},U=!0,G=i(F)):M={left:F?E.cornerSide:E.spreadWidth-E.cornerSide,top:E.pageHeight-E.cornerSide}}}}function k(a){if(W=!0,V=!1,!U){var b=$(J).position(),c={top:a.pageY-b.top-E.pageHeightOffset,left:a.pageX-b.left};c.top>=0&&c.top<E.pageHeight&&(c.left>=0&&c.left<E.pageWidth?(M={left:E.cornerSide,top:E.pageHeight-E.cornerSide},F||(F=!0,N={left:0,top:E.pageHeight})):c.left>=E.pageWidth&&c.left<E.spreadWidth?(M={left:E.spreadWidth-E.cornerSide,top:E.pageHeight-E.cornerSide},F&&(F=!1,N={left:E.spreadWidth,top:E.pageHeight})):M={left:F?0:E.spreadWidth,top:E.pageHeight},a.preventDefault(),T=!0)}}function l(a){T||U||(M={left:F?0:E.spreadWidth,top:E.pageHeight})}function m(a){if(W=!1,!T&&!U){var b=$(J).position(),c={top:a.pageY-b.top-E.pageHeightOffset,left:a.pageX-b.left};c.top>=0&&c.top<E.pageHeight?c.left>=0&&c.left<E.pageWidth?(M={left:E.cornerSide,top:E.pageHeight-E.cornerSide},F||(F=!0,N={left:0,top:E.pageHeight})):c.left>=E.pageWidth&&c.left<E.spreadWidth?(M={left:E.spreadWidth-E.cornerSide,top:E.pageHeight-E.cornerSide},F&&(F=!1,N={left:E.spreadWidth,top:E.pageHeight})):M={left:F?0:E.spreadWidth,top:E.pageHeight}:M={left:F?0:E.spreadWidth,top:E.pageHeight}}}function n(){null!=G&&(G(),G=null),U=!1}function o(){if(null!=M){var a=(M.top-N.top)*E.easing,b=(M.left-N.left)*E.easing;if(b=Math.abs(b)<.5?0:b,a=Math.abs(a)<.5?0:a,0==b&&0==a)return void n();N.top+=a,N.left+=b;var c,d,e=N.left-E.pageWidth,f=R-N.top,g=Math.atan2(f,e),h=Math.cos(g)*E.pageWidth+E.pageWidth,i=R-Math.sin(g)*E.pageWidth,j=Math.sqrt((R-N.top)*(R-N.top)+(N.left-E.pageWidth)*(N.left-E.pageWidth)),k=Math.sqrt((R-i)*(R-i)+(h-E.pageWidth)*(h-E.pageWidth));j>k?(c=h,d=i):(c=N.left,d=N.top),e=P-c,f=d,j=Math.sqrt(e*e+f*f);var l=Math.atan2(f,e);if(j>E.pageDiagonal){var m=-Math.cos(l)*E.pageDiagonal+E.pageWidth,o=Q+Math.sin(l)*E.pageDiagonal;c=m,d=o}var q=F?c/2:(2*E.pageWidth-c)/2+c,r=(E.pageHeight-d)/2+d,s=Math.atan2(E.pageHeight-r,F?q:2*E.pageWidth-q),t=Math.tan(s)*(E.pageHeight-r),u=q+t*(F?1:-1);0>u&&(u=0);var v=S-d,w=u-c;O=F?Math.atan2(-v,-w):Math.atan2(v,w);var x=c+E.pageWidth/2*Math.cos(O)*(F?-1:1)+E.pageHeight/2*Math.sin(O),y=d-E.pageHeight/2*Math.cos(O)+E.pageWidth/2*Math.sin(O)*(F?-1:1),z=Math.atan2(E.pageHeight-r,q-u),A=90*(z/Math.abs(z))-180*z/Math.PI;A=A/180*Math.PI;var B=S-r,C=q-u,D=u*r-q*S,G=-(C*E.pageHeight/2+D)/B,H=E.pageClipWidth/2/Math.cos(A),I=G+H*(F?1:-1),J=E.pageHeight/2,K=I+(F?3*-H:H);p(x,y,O,I,J,A,K)}}function p(a,b,c,d,e,f,g){L.clearRect(0,0,I.width(),I.height()),L.save(),L.translate(d,e+E.pageHeightOffset),L.rotate(f),L.beginPath(),L.rect(-E.pageClipWidth/2,-E.pageClipHeight/2,E.pageClipWidth,E.pageClipHeight),L.clip(),L.rotate(-f),L.translate(-d,-e-E.pageHeightOffset),L.translate(a,b+E.pageHeightOffset),L.rotate(c),u(L,B(),-E.pageWidth/2,-E.pageHeight/2),L.restore(),L.save(),L.translate(g,e+E.pageHeightOffset),L.rotate(f),L.beginPath(),L.rect(0,-E.pageDiagonal,E.pageClipWidth,E.pageClipHeight),L.clip(),L.rotate(-f),L.translate(-g,-e-E.pageHeightOffset),L.translate(0,0),u(L,C(),F?0:E.pageWidth,E.pageHeightOffset),L.restore()}function q(){var a=function(){r(),setTimeout(a,E.updateDelay)};a()}function r(){o()}function s(a){e(a),d(),f(),q(),v();var b=$("div.content li img",a);Y=b.length+2;for(var c=0;c<b.length;c++)Z[c]=X,x(b,c);b.length%2==1&&(Z.push(X),Y++),t()}function t(){var a=z(),b=A();null!=a?(E.shadow&&(K.shadowBlur=E.shadow.blur,K.shadowColor=E.shadow.color,K.clearRect(0,E.pageHeightOffset+E.pageHeight,2*E.pageWidth,E.pageHeightOffset),K.clearRect(0,0,2*E.pageWidth,E.pageHeightOffset)),u(K,a,0,E.pageHeightOffset),E.nonSolidBackground&&"background"==a.type&&K.clearRect(0,0,E.pageWidth,E.pageHeight+2*E.pageHeightOffset)):K.clearRect(0,E.pageHeightOffset,E.pageWidth,E.pageHeight),null!=b?(u(K,b,E.pageWidth,E.pageHeightOffset),E.nonSolidBackground&&"background"==b.type&&K.clearRect(E.pageWidth,0,E.pageWidth,E.pageHeight+2*E.pageHeightOffset)):K.clearRect(E.pageWidth,E.pageHeightOffset,E.pageWidth,E.pageHeight)}function u(a,b,c,d){null!=b&&null!=b.type&&b.type.length>0&&("image"==b.type&&null!=b.data?b.isLoaded&&a.drawImage(b.data,c,d):"background"==b.type&&(a.fillStyle=E.backgroundColor,a.fillRect(c,d,E.pageWidth,E.pageHeight)))}function v(){var a=$("<canvas></canvas>");a.attr("width",E.pageWidth).attr("height",E.pageHeight);var b=a[0].getContext("2d");b.fillStyle=E.defaultPageColor,b.fillRect(0,0,E.pageWidth,E.pageHeight);var c=new Image;c.onload=function(){X.isLoaded=!0},c.src=a[0].toDataURL(),X={type:"image",data:c,isLoaded:!1}}function w(a){return 0==a||a==Y-1?{type:"background"}:Z[a-1]}function x(a,b){var c=$(a[b]).attr("src");y(c,function(a){Z[b]={type:"image",data:a,isLoaded:!0},b!=_&&b!=_+1||t()})}function y(a,b){var c=new Image;c.onload=function(){b(c)},c.src=a}function z(){return w(_)}function A(){return w(_+1)}function B(){return w(F?_-1:_+2)}function C(){return w(F?_-2:_+3)}console.log("FlipperStart");var D={className:"canvasHolder",pageWidth:b/2-10,pageHeight:c-10-40,easing:.5,fps:20,defaultPageColor:"green",backgroundColor:"green",cornerSide:50},E=$.extend(D,a);E.updateDelay=1e3/E.fps,E.spreadWidth=2*E.pageWidth,E.pageDiagonal=Math.sqrt(E.pageWidth*E.pageWidth+E.pageHeight*E.pageHeight),E.pageClipWidth=E.pageWidth,E.pageClipHeight=10*E.pageWidth,E.pageHeightOffset=20;var F,G,H=null,I=null,J=null,K=null,L=null,M=null,N=null,O=0,P=E.pageWidth,Q=0,R=E.pageHeight,S=E.pageHeight,T=!1,U=!1,V=!1,W=!1,X=null,Y=0,Z=[],_=0;return this.getImageIndex=function(){return _},this.nextPage=function(){F=!1,h()},this.prevPage=function(){F=!0,h()},this.goToPage=function(a){a>_?(_=a-2,this.nextPage()):_>a&&(_=a+2,this.prevPage())},this.each(function(){s(this)})}}(jQuery);
//# sourceMappingURL=jquery.pageFlipper.min.js.map